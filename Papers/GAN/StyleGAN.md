# [A Style-Based Generator Architecture for Generative Adversarial Networks](https://arxiv.org/pdf/1812.04948.pdf)

## Abstract

我们借鉴风格迁移文献，为生成对抗网络提出另外一种可供选择的生成器架构。新的架构导致了一种对图像中高级属性 (例如，在人脸上训练时的姿态和身份) 和随机变化 (例如雀斑和头发等) 的自动学习的、无监督的解耦分离，并且它使能了对合成的直观的、规模特定的控制。新的生成器在传统的分布质量指标上提高了 state-of-the-art，导致明显更好的插值特性，也更好地解开了变化的潜在因素。为了量化插值质量和解纠缠度，我们提出了两种新的、自动化的方法，适用于任意生成器架构。最后，我们引入了一个新的、高度多样化和高质量的人脸数据集。

## 1. Introduction

 生成方法，特别是生成对抗网络 (GAN) 产生的图像的分辨率和质量，最近得到了快速的提升。然而，生成器仍然像黑匣子一样运行，尽管最近有一些工作，但对图像合成过程的各个方面，如随机特征的起源等，仍然缺乏了解。人们对潜在空间的性质也是知之甚少，常用的潜在空间插值提供了无定量的方法来比较不同的生成器。

受风格迁移文献的启发，我们以一种控制图像合成过程的新方法重新设计了生成器的架构。我们的生成器从一个学习后的常量输入开始，并基于潜在编码调整每个卷积层的图像 "风格"，从而直接控制不同尺度下的图像特征的强度。结合直接注入到网络中的噪声，这种架构的变化导致对生成图像中高级属性 (例如姿态和身份) 和随机变化 (例如雀斑和头发) 的自动化的、无监督的分离，并使得直观的规模特定的混合和插值操作称为可能。我们没有以任何方式修改鉴别器和损失函数，因此我们的工作正交于正在进行的关于 GAN 损失函数、正则化和超参数的讨论。

我们的生成器将输入的潜在编码嵌入到一个中间的潜在空间，这对变化的因素如何在网络中表示有着深远的影响。输入的潜在空间必须遵循训练数据的概率密度 ，我们认为这导致某种程度的不可避免的纠缠。我们的中间潜在空间不受这种限制，因此可以被解开纠缠。由于以前的估计潜在空间解纠缠度的方法不能直接地适用于我们的情况，我们提出了两种新的自动的方法——感知路径长度和线性可分性，来量化生成器的这些方面。使用这些指标，我们表明，与传统的生成器架构相比，我们的生成器容许对变化的不同因素有更线性的、更少纠缠的表示。

最后，我们提出了一个新的人脸数据集 (Flickr-Faces-HQ, FFHQ)，它提供了比现有的高分辨率数据集 (附录 A) 更高质的质量和覆盖更加广泛的变化。我们已经公开了这个数据集，以及我们的源码和预训练模型。所附的视频可以在同一链接下找到。

## 2. Style-based generator

传统上，潜在编码是通过输入层即前馈网络 (图 1a) 的第一层，提供给生成器。我们通过完全地省略输入层，并从一个学习后的常量开始代替这种设计。给定一个在输入空间 $\mathcal{Z}$ 的潜在编码 $\bold{z}$，一个非线性的映射网络：$f:\mathcal{Z} \rightarrow \mathcal{W}$ 首先生成 $\bold{w} \in \mathcal{W}$ (图 1b，左)。为了简单起见，我们将两个空间的维度设为 512，并用一个 8 层的 MLP 实现映射 $f$，我们将在 4.1 节分析这个决策。